@model ArchiveDomain.Model.Query

@{
    ViewData["Title"] = "Результати запиту";
}

<div class="page-content">
    <h1 class="mb-4">Результати запиту @Model.QueryName</h1>

    @if (Model.ErrorFlag == 1)
    {
        <div class="alert alert-danger">
            @Model.ErrorName
        </div>
    }
    else
    {
        @switch (Model.QueryName)
        {
            case "Q1":
                <h4 class="mb-3">Вірші автора з прізвищем <b>@Model.LastName</b>, у назві яких є <b>@Model.Keyword</b>, з >= @Model.MinLikes лайків</h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Назва</th>
                            <th>Текст</th>
                            <th>Дата публікації</th>
                            <th>Автор</th>
                            <th>Мова</th>
                            <th>Адміністратор</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Poems.Any())
                        {
                            <tr><td colspan="7" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var poem in Model.Poems)
                            {
                                <tr>
                                    <td data-label="ID">@poem.Id</td>
                                    <td data-label="Назва">@poem.Title</td>
                                    <td data-label="Текст">@poem.Text</td>
                                    <td data-label="Дата публікації">@poem.PublicationDate.ToString("dd.MM.yyyy")</td>
                                    <td data-label="Автор">@poem.AuthorName</td>
                                    <td data-label="Мова">@poem.LanguageName</td>
                                    <td data-label="Адміністратор">@poem.AdminName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q2":
                <h4 class="mb-3">Автори, які писали мовою <b>@Model.LanguageName</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Повне ім'я</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Authors.Any())
                        {
                            <tr><td colspan="2" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var author in Model.Authors)
                            {
                                <tr>
                                    <td data-label="ID">@author.Id</td>
                                    <td data-label="Повне ім'я">@author.FullName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q3":
                <h4 class="mb-3">Жанри віршів, опублікованих після <b>@Model.AfterDate.Value.ToString("dd.MM.yyyy")</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>Жанр</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Genres.Any())
                        {
                            <tr><td colspan="1" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var genre in Model.Genres)
                            {
                                <tr>
                                    <td data-label="Жанр">@genre</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q4":
                <h4 class="mb-3">Користувачі, які лайкали жанр <b>@Model.FormName</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Ім'я користувача</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Users.Any())
                        {
                            <tr><td colspan="2" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var user in Model.Users)
                            {
                                <tr>
                                    <td data-label="ID">@user.Id</td>
                                    <td data-label="Ім'я користувача">@user.UserName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q5":
                <h4 class="mb-3">Вірші адміна <b>@Model.AdminName</b> мовою <b>@Model.LanguageName</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Назва</th>
                            <th>Текст</th>
                            <th>Дата публікації</th>
                            <th>Автор</th>
                            <th>Мова</th>
                            <th>Адміністратор</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Poems.Any())
                        {
                            <tr><td colspan="7" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var poem in Model.Poems)
                            {
                                <tr>
                                    <td data-label="ID">@poem.Id</td>
                                    <td data-label="Назва">@poem.Title</td>
                                    <td data-label="Текст">@poem.Text</td>
                                    <td data-label="Дата публікації">@poem.PublicationDate.ToString("dd.MM.yyyy")</td>
                                    <td data-label="Автор">@poem.AuthorName</td>
                                    <td data-label="Мова">@poem.LanguageName</td>
                                    <td data-label="Адміністратор">@poem.AdminName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q6":
                <h4 class="mb-3">Користувачі з такими ж лайками, як користувач <b>@Model.UserName</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Ім'я користувача</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Users.Any())
                        {
                            <tr><td colspan="2" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var user in Model.Users)
                            {
                                <tr>
                                    <td data-label="ID">@user.Id</td>
                                    <td data-label="Ім'я користувача">@user.UserName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q7":
                <h4 class="mb-3">Автори, які писали у тих самих жанрах, що й автор <b>@Model.LastName</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Повне ім'я</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Authors.Any())
                        {
                            <tr><td colspan="2" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var author in Model.Authors)
                            {
                                <tr>
                                    <td data-label="ID">@author.Id</td>
                                    <td data-label="Повне ім'я">@author.FullName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            case "Q8":
                <h4 class="mb-3">Користувачі, які лайкнули всі вірші автора <b>@Model.LastName</b></h4>
                <table class="table table-striped table-hover">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Ім'я користувача</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (!Model.Users.Any())
                        {
                            <tr><td colspan="2" class="text-muted text-center">Результатів не знайдено</td></tr>
                        }
                        else
                        {
                            foreach (var user in Model.Users)
                            {
                                <tr>
                                    <td data-label="ID">@user.Id</td>
                                    <td data-label="Ім'я користувача">@user.UserName</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
                break;

            default:
                <p class="text-muted">Невідомий запит.</p>
                break;
        }
    }

    <div class="mt-3">
        <a asp-action="Index" class="btn btn-secondary">Повернутися до меню запитів</a>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>
}